1. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –¥–∞–Ω—ñ:

	a) –°—Ç–≤–æ—Ä—ñ—Ç—å —Å—Ö–µ–º—É pandemic —É –±–∞–∑—ñ –¥–∞–Ω–∏—Ö –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é SQL-–∫–æ–º–∞–Ω–¥–∏.
	b) –û–±–µ—Ä—ñ—Ç—å —ó—ó —è–∫ —Å—Ö–µ–º—É –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é SQL-–∫–æ–º–∞–Ω–¥–∏.
	c) –Ü–º–ø–æ—Ä—Ç—É–π—Ç–µ –¥–∞–Ω—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Import wizard —Ç–∞–∫, —è–∫ –≤–∏ –≤–∂–µ —Ä–æ–±–∏–ª–∏ —Ü–µ —É —Ç–µ–º—ñ 3.
	d) –ü—Ä–æ–¥–∏–≤—ñ—Ç—å—Å—è –¥–∞–Ω—ñ, —â–æ–± –±—É—Ç–∏ —É –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ.



a) –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å—Ö–µ–º–∏
CREATE DATABASE IF NOT EXISTS pandemic;

b) –û–±—Ä–∞–Ω–Ω—è —ó—ó —è–∫ —Å—Ö–µ–º–∏ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º
USE pandemic;

d) –í–∏–≤—ñ–¥ 10 —Ä—è–¥–∫—ñ–≤, –¥–ª—è —Ä–æ–∑—É–º—ñ–Ω–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É —ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —ñ–º–ø–æ—Ä—Ç—É
SELECT * FROM infectious_cases LIMIT 10;


2. –ù–æ—Ä–º–∞–ª—ñ–∑—É–π—Ç–µ —Ç–∞–±–ª–∏—Ü—é infectious_cases –¥–æ 3—ó –Ω–æ—Ä–º–∞–ª—å–Ω–æ—ó —Ñ–æ—Ä–º–∏. –ó–±–µ—Ä–µ–∂—ñ—Ç—å —É —Ü—ñ–π –∂–µ —Å—Ö–µ–º—ñ –¥–≤—ñ —Ç–∞–±–ª–∏—Ü—ñ –∑ –Ω–æ—Ä–º–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏.

SELECT COUNT(*) FROM infectious_cases
–≤–∏–¥–∞—î 7271 —Ä—è–¥–∫—ñ–≤ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ –±—É–ª–æ

–î–ª—è –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è 3-—ó –Ω–æ—Ä–º–∞–ª—å–Ω–æ—ó —Ñ–æ—Ä–º–∏ –º–∏ —Ä–æ–∑–¥—ñ–ª–∏–º–æ –Ω–∞—à—É —Ç–∞–±–ª–∏—Ü—é –Ω–∞ –¥–≤—ñ: –æ–¥–Ω–∞ –¥–ª—è –¥–æ–≤—ñ–¥–Ω–∏–∫–∞ –∫—Ä–∞—ó–Ω, 
—ñ–Ω—à–∞ ‚Äî –¥–ª—è —Å–∞–º–∏—Ö –ø–æ–∫–∞–∑–Ω–∏–∫—ñ–≤ –∑–∞—Ö–≤–æ—Ä—é–≤–∞–Ω–æ—Å—Ç—ñ, —Ü–µ —É—Å—É–≤–∞—î —Ç—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω—É –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å.

–°—Ç–≤–æ—Ä—é—î–º–æ —Ç–∞–±–ª–∏—Ü—é –∫—Ä–∞—ó–Ω
CREATE TABLE countries (
    country_id INT AUTO_INCREMENT PRIMARY KEY,
    entity_name VARCHAR(255) NOT NULL,
    entity_code VARCHAR(10)
);

–ù–∞–ø–æ–≤–Ω—é—î–º–æ —ó—ó —Å–∞–º–µ —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏ –∑—ñ —Å—Ç–∞—Ä–æ—ó —Ç–∞–±–ª–∏—Ü—ñ
INSERT INTO countries (entity_name, entity_code)
SELECT DISTINCT Entity, Code 
FROM infectious_cases;

–¢–µ–ø–µ—Ä –º–∏ —Å—Ç–≤–æ—Ä—é—î–º–æ —Ç–∞–±–ª–∏—Ü—é infectious_cases_normalized, –¥–µ –∑–∞–º—ñ—Å—Ç—å —Ç–µ–∫—Å—Ç–æ–≤–∏—Ö –Ω–∞–∑–≤ –∫—Ä–∞—ó–Ω –±—É–¥–µ –ª–∏—à–µ —á–∏—Å–ª–æ–≤–∏–π —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä country_id.
CREATE TABLE infectious_cases_normalized (
    case_id INT AUTO_INCREMENT PRIMARY KEY,
    country_id INT,
    year INT,
    number_yaws FLOAT,
    polio_cases FLOAT,
    cases_guinea_worm FLOAT,
    number_rabies FLOAT,
    number_malaria FLOAT,
    number_hiv FLOAT,
    number_tuberculosis FLOAT,
    number_smallpox FLOAT,
    number_cholera_cases FLOAT,
    FOREIGN KEY (country_id) REFERENCES countries(country_id)
);

–ó–∞–ø–æ–≤–Ω—é—î–º–æ —ó—ó –∑—ñ —Å—Ç–∞—Ä–æ—ó –º–∞—Ç–µ—Ä–∏–Ω—Å—å–∫–æ—ó —Ç–∞–±–ª–∏—Ü—ñ.
–¢—É—Ç –∑—ñ—à—Ç–æ–≤—Ö–Ω—É–≤—Å—è –∑ –ø—Ä–æ–±–ª–µ–º–æ—é "–ª–∞–ø–∫—ñ–≤" –ø–æ—Ç—ñ–º –ø–æ–±–∞—á–∏–≤ –≤ –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É –∑–∞–≤–¥–∞–Ω–Ω—è –Ω–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è –ø—Ä–æ —Ü–µ. –í–∏—Ä—ñ—à–∏–≤ —á–µ—Ä–µ—Ö NULLIF
INSERT INTO infectious_cases_normalized (
    country_id, year, number_yaws, polio_cases, cases_guinea_worm, 
    number_rabies, number_malaria, number_hiv, number_tuberculosis, 
    number_smallpox, number_cholera_cases
)
SELECT 
    c.country_id, 
    ic.Year, 
    NULLIF(ic.Number_yaws, ''), 
    NULLIF(ic.polio_cases, ''), 
    NULLIF(ic.cases_guinea_worm, ''), 
    NULLIF(ic.Number_rabies, ''), 
    NULLIF(ic.Number_malaria, ''), 
    NULLIF(ic.Number_hiv, ''), 
    NULLIF(ic.Number_tuberculosis, ''), 
    NULLIF(ic.Number_smallpox, ''), 
    NULLIF(ic.Number_cholera_cases, '')
FROM infectious_cases ic
JOIN countries c ON ic.Entity = c.entity_name 
    AND (ic.Code = c.entity_code OR (ic.Code IS NULL AND c.entity_code IS NULL));

–Ü –ø–µ—Ä–µ–≤—ñ—Ä–∏–º–æ, —â–æ —Ç–∞–±–ª–∏—Ü—ñ –∑'—î–¥–Ω–∞–Ω—ñ –ø—Ä–∞–≤–∏–ª—å–Ω–æ
SELECT c.entity_name, icn.year, icn.polio_cases
FROM infectious_cases_normalized icn
JOIN countries c ON icn.country_id = c.country_id
LIMIT 10;


3. –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–π—Ç–µ –¥–∞–Ω—ñ:
–î–ª—è –∫–æ–∂–Ω–æ—ó —É–Ω—ñ–∫–∞–ª—å–Ω–æ—ó –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—ó Entity —Ç–∞ Code –∞–±–æ —ó—Ö id –ø–æ—Ä–∞—Ö—É–π—Ç–µ —Å–µ—Ä–µ–¥–Ω—î, –º—ñ–Ω—ñ–º–∞–ª—å–Ω–µ, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∞ —Å—É–º—É –¥–ª—è 
–∞—Ç—Ä–∏–±—É—Ç–∞ Number_rabies.
üí° –í—Ä–∞—Ö—É–π—Ç–µ, —â–æ –∞—Ç—Ä–∏–±—É—Ç Number_rabies –º–æ–∂–µ –º—ñ—Å—Ç–∏—Ç–∏ –ø–æ—Ä–æ–∂–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è ‚Äò‚Äô ‚Äî –≤–∞–º –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ —ó—Ö –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏.
–†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ñ–¥—Å–æ—Ä—Ç—É–π—Ç–µ –∑–∞ –ø–æ—Ä–∞—Ö–æ–≤–∞–Ω–∏–º —Å–µ—Ä–µ–¥–Ω—ñ–º –∑–Ω–∞—á–µ–Ω–Ω—è–º —É –ø–æ—Ä—è–¥–∫—É —Å–ø–∞–¥–∞–Ω–Ω—è.
–û–±–µ—Ä—ñ—Ç—å —Ç—ñ–ª—å–∫–∏ 10 —Ä—è–¥–∫—ñ–≤ –¥–ª—è –≤–∏–≤–µ–¥–µ–Ω–Ω—è –Ω–∞ –µ–∫—Ä–∞–Ω.


SELECT 
    c.entity_name, 
    c.entity_code, 
    AVG(icn.number_rabies) AS avg_rabies, 
    MIN(icn.number_rabies) AS min_rabies, 
    MAX(icn.number_rabies) AS max_rabies, 
    SUM(icn.number_rabies) AS sum_rabies
FROM 
    infectious_cases_normalized icn
JOIN 
    countries c ON icn.country_id = c.country_id
-- –í—ñ–¥—Ñ—ñ–ª—å—Ç—Ä–æ–≤—É—î–º–æ –∑–∞–ø–∏—Å–∏, –¥–µ –¥–∞–Ω—ñ –ø—Ä–æ —Å–∫–∞–∑ –≤—ñ–¥—Å—É—Ç–Ω—ñ
WHERE 
    icn.number_rabies IS NOT NULL
GROUP BY 
    c.country_id, c.entity_name, c.entity_code
-- –°–æ—Ä—Ç—É—î–º–æ –∑–∞ —Å–µ—Ä–µ–¥–Ω—ñ–º –∑–Ω–∞—á–µ–Ω–Ω—è–º —É –ø–æ—Ä—è–¥–∫—É —Å–ø–∞–¥–∞–Ω–Ω—è
ORDER BY 
    avg_rabies DESC
-- –û–±–º–µ–∂—É—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç 10 —Ä—è–¥–∫–∞–º–∏
LIMIT 10;

–ü—Ä–æ–±–ª–µ–º—É –∑ –ª–∞–ø–∫–∞–º–∏ –≤–∂–µ –≤–∏—Ä—ñ—à–∏–≤ –≤ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É –∑–∞–≤–¥–∞–Ω–Ω—ñ, —Ç–æ –ø—Ä–∞—Ü—é–≤–∞–≤ –∑ NULL.


4. –ü–æ–±—É–¥—É–π—Ç–µ –∫–æ–ª–æ–Ω–∫—É —Ä—ñ–∑–Ω–∏—Ü—ñ –≤ —Ä–æ–∫–∞—Ö.
–î–ª—è –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–æ—ó –∞–±–æ –Ω–æ—Ä–º–æ–≤–∞–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ –¥–ª—è –∫–æ–ª–æ–Ω–∫–∏ Year –ø–æ–±—É–¥—É–π—Ç–µ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º –≤–±—É–¥–æ–≤–∞–Ω–∏—Ö SQL-—Ñ—É–Ω–∫—Ü—ñ–π:
- –∞—Ç—Ä–∏–±—É—Ç, —â–æ —Å—Ç–≤–æ—Ä—é—î –¥–∞—Ç—É –ø–µ—Ä—à–æ–≥–æ —Å—ñ—á–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ–≥–æ —Ä–æ–∫—É,
üí° –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ –∞—Ç—Ä–∏–±—É—Ç –º—ñ—Å—Ç–∏—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è ‚Äô1996‚Äô, —Ç–æ –∑–Ω–∞—á–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –∞—Ç—Ä–∏–±—É—Ç–∞ –º–∞—î –±—É—Ç–∏ ‚Äò1996-01-01‚Äô.
- –∞—Ç—Ä–∏–±—É—Ç, —â–æ –¥–æ—Ä—ñ–≤–Ω—é—î –ø–æ—Ç–æ—á–Ω—ñ–π –¥–∞—Ç—ñ,
- –∞—Ç—Ä–∏–±—É—Ç, —â–æ –¥–æ—Ä—ñ–≤–Ω—é—î —Ä—ñ–∑–Ω–∏—Ü—ñ –≤ —Ä–æ–∫–∞—Ö –¥–≤–æ—Ö –≤–∏—â–µ–∑–≥–∞–¥–∞–Ω–∏—Ö –∫–æ–ª–æ–Ω–æ–∫.
üí° –ü–µ—Ä–µ—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ –≤—Å—ñ —ñ–Ω—à—ñ –∞—Ç—Ä–∏–±—É—Ç–∏, —Ç–∞–∫—ñ —è–∫ Number_malaria, –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ.


–í—ñ–∑—å–º–µ–º–æ –Ω–æ—Ä–º–æ–≤–∞–Ω—É —Ç–∞–±–ª–∏—Ü—é. –°–ø–æ—á–∞—Ç–∫—É —Å—Ç–≤–æ—Ä–∏–º–æ first_january_date –¥–æ–¥–∞–≤—à–∏ –¥–æ —Ä–æ–∫—É —Ç–µ–∫—Å—Ç –¥–∞—Ç–∏ —ñ –ø–µ—Ä–µ–≤–µ–¥–µ–º–æ –π–æ–≥–æ –≤ —Ñ–æ—Ä–º–∞—Ç–∏ –¥–∞—Ç–∏, –∞ –Ω–µ —Ä—è–¥–∫–∞ –≤–±—É–¥–æ–≤–∞–Ω–∏–º–∏ —Ñ—É–Ω–∫—Ü—ñ—è–º–∏
CONCAT —Ç–∞ STR_TO_DATE. –î–∞–ª—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ CURDATE —Ç–∞ TIMESTAMPDIFF –¥–ª—è today_date —Ç–∞ year_difference

SELECT 
    year,
    STR_TO_DATE(CONCAT(year, '-01-01'), '%Y-%m-%d') AS first_january_date,
    CURDATE() AS today_date,
    TIMESTAMPDIFF(YEAR, STR_TO_DATE(CONCAT(year, '-01-01'), '%Y-%m-%d'), CURDATE()) AS year_difference
FROM 
    infectious_cases_normalized;


5. –ü–æ–±—É–¥—É–π—Ç–µ –≤–ª–∞—Å–Ω—É —Ñ—É–Ω–∫—Ü—ñ—é.
–°—Ç–≤–æ—Ä—ñ—Ç—å —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü—ñ—é, —â–æ –±—É–¥—É—î —Ç–∞–∫–∏–π –∂–µ –∞—Ç—Ä–∏–±—É—Ç, —è–∫ —ñ –≤ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É –∑–∞–≤–¥–∞–Ω–Ω—ñ: 
—Ñ—É–Ω–∫—Ü—ñ—è –º–∞—î –ø—Ä–∏–π–º–∞—Ç–∏ –Ω–∞ –≤—Ö—ñ–¥ –∑–Ω–∞—á–µ–Ω–Ω—è —Ä–æ–∫—É, –∞ –ø–æ–≤–µ—Ä—Ç–∞—Ç–∏ —Ä—ñ–∑–Ω–∏—Ü—é –≤ —Ä–æ–∫–∞—Ö –º—ñ–∂ –ø–æ—Ç–æ—á–Ω–æ—é –¥–∞—Ç–æ—é —Ç–∞ –¥–∞—Ç–æ—é, 
—Å—Ç–≤–æ—Ä–µ–Ω–æ—é –∑ –∞—Ç—Ä–∏–±—É—Ç–∞ —Ä–æ–∫—É (1996 —Ä—ñ–∫ ‚Üí ‚Äò1996-01-01‚Äô).

–ú–æ–∂–Ω–∞ –±—É–ª–æ –± —ñ–Ω–∫–∞–ø—Å—É–ª—é–≤–∞—Ç–∏ –ª–æ–≥—ñ–∫—É –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è –≤ —Ñ—É–Ω–∫—Ü—ñ—é –¥–ª—è, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø–æ–≤—Ç–æ—Ä—é–≤–∞–Ω–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —ñ –∑–∞–≤–µ—Ä–Ω—É—Ç–∏
—Ç–∞–∫—ñ –≤–±—É–¥–æ–≤–∞–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó —è–∫ STR_TO_DATE, CURDATE, TIMESTAMPDIFF –≤ –æ–±–≥–æ—Ä—Ç–∫—É –Ω–æ–≤–æ—ó —Ñ—É–Ω–∫—Ü—ñ—é. –ê–ª–µ –º–æ–∂–ª–∏–≤–æ "–≤–ª–∞—Å–Ω–∞" —Ñ—É–Ω–∫—Ü—ñ—è –º–∞–ª–∞ –± 
–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –º—ñ–Ω—ñ–º—É–º –≤–∂–µ –≤–±—É–¥–æ–≤–∞–Ω–∏—Ö (–±–µ–∑ CURDATE, –∞–±–æ NOW –≤–∞–∂–∫–æ –±—É–¥–µ). –¢–æ —Å–ø—Ä–æ–±—É—î–º–æ –Ω–∞–ø–∏—Å–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é, —è–∫–∞ –±—É–¥–µ –≤–∏—Ä—ñ—à—É–≤–∞—Ç–∏ –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–µ –∑–∞–≤–¥–∞–Ω–Ω—è,
–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –ª–∏—à–µ–µ NOW —ñ –º–∞—Ç–µ–º–∞—Ç–∏–∫—É.

DELIMITER //

CREATE FUNCTION GetYearDifferenceMath(input_year INT) 
RETURNS INT
DETERMINISTIC
BEGIN
    DECLARE current_full_number BIGINT;
    DECLARE current_year INT;
    
    -- –û—Ç—Ä–∏–º—É—î–º–æ –ø–æ—Ç–æ—á–Ω—É –¥–∞—Ç—É —è–∫ —á–∏—Å–ª–æ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 20240522...) —ñ –ø–µ—Ä–µ–≤–æ–¥–∏–º–æ –≤ —á–∏—Å–ª–æ –∑ –¥–∞—Ç–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—è–º
    SET current_full_number = NOW() + 0;
    
    -- –ú–∞—Ç–µ–º–∞—Ç–∏—á–Ω–æ "–≤—ñ–¥—Ä—ñ–∑–∞—î–º–æ" –æ—Å—Ç–∞–Ω–Ω—ñ 10 —Ü–∏—Ñ—Ä (–º—ñ—Å—è—Ü—ñ, –¥–Ω—ñ, –≥–æ–¥–∏–Ω–∏ —ñ —Ç.–¥.), –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è –ø–µ—Ä—à—ñ 4 —Ü–∏—Ñ—Ä–∏ ‚Äî —Ü–µ —ñ —î –Ω–∞—à —Ä—ñ–∫
    SET current_year = current_full_number DIV 10000000000;
    
    -- –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ —á–∏—Å—Ç—É —Ä—ñ–∑–Ω–∏—Ü—é
    RETURN current_year - input_year;
END //

DELIMITER ;


–ó–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è:
SELECT 
    year, 
    GetYearDifferenceMath(year) AS years_diff
FROM 
    infectious_cases_normalized;